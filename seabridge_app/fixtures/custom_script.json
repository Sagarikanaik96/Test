[
 {
  "docstatus": 0,
  "doctype": "Custom Script",
  "dt": "Request for Quotation",
  "modified": "2020-09-01 17:00:59.030833",
  "name": "Request for Quotation-Client",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Request for Quotation', { \non_submit:function(frm,cdt,cdn){\n      var doc=frm.doc;\n        $.each(doc.suppliers,function(idx,supplier){\n            var company;\n            frappe.call({\n                type: \"GET\",\n                url: \"/api/method/get_company_name\",\n                args:{\n                    doctype:'Supplier',\n                    is_internal_supplier:1,\n                    supplier_name:supplier.supplier\n                },\n               async:false,\n                callback: function(r){\n                    company=r.company;\n                }\n            });\n            if(company!==null){\n                var emailTemplate='<h1><strong> Opportunity is created</strong></h1>';\n                sendEmail(doc.name,supplier.email_id,emailTemplate);\n            }\n            else{\n                 var emailTemplate1='<h1><strong>Unable to create an Opportunity because you donot have any company associated with yourself</strong></h1>';\n                sendEmail(doc.name,supplier.email_id,emailTemplate1);\n            }\n        });\n}\n});\nfunction sendEmail(name,email,template){\nfrappe.call({\n                    method: \"frappe.core.doctype.communication.email.make\",\n                    args: {\n                        subject: name,\n                        communication_medium: \"Email\",\n                        recipients: email,\n                        content: template,\n                        communication_type: \"Communication\",\n                        send_email:1,\n                        attachments:[],\n                        print_format:\"Standard\",\n                        doctype: \"Request for Quotation\",\n                        name: name,\n                        print_letterhead: 0\n                    },\n                    callback: function(rh){\n                        console.log(\"sent\");\n                    }   \n                });\n}"
 }
]